[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 tidyCoverage authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/tidyCoverage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to tidyCoverage","text":"…","code":""},{"path":[]},{"path":"/articles/tidyCoverage.html","id":"coverageexperiment","dir":"Articles","previous_headings":"New classes","what":"CoverageExperiment","title":"Introduction to tidyCoverage","text":"","code":"library(tidyCoverage) showClass(\"CoverageExperiment\") #> Class \"CoverageExperiment\" [package \"tidyCoverage\"] #>  #> Slots: #>                                                                  #> Name:                     rowRanges                      colData #> Class: GenomicRanges_OR_GRangesList                    DataFrame #>                                                                  #> Name:                        assays                        NAMES #> Class:               Assays_OR_NULL            character_OR_NULL #>                                                                  #> Name:               elementMetadata                     metadata #> Class:                    DataFrame                         list #>  #> Extends:  #> Class \"RangedSummarizedExperiment\", directly #> Class \"SummarizedExperiment\", by class \"RangedSummarizedExperiment\", distance 2 #> Class \"RectangularData\", by class \"RangedSummarizedExperiment\", distance 3 #> Class \"Vector\", by class \"RangedSummarizedExperiment\", distance 3 #> Class \"Annotated\", by class \"RangedSummarizedExperiment\", distance 4 #> Class \"vector_OR_Vector\", by class \"RangedSummarizedExperiment\", distance 4  data(ce) ce #> class: CoverageExperiment  #> dim: 1 2  #> metadata(0): #> assays(1): coverage #> rownames(1): Scc1 #> rowData names(1): features #> colnames(2): RNA_fwd RNA_rev #> colData names(1): track #> width: 3000  rowData(ce) #> DataFrame with 1 row and 1 column #>         features #>      <character> #> Scc1        Scc1  rowRanges(ce) #> GRangesList object of length 1: #> $Scc1 #> GRanges object with 614 ranges and 2 metadata columns: #>         seqnames          ranges strand |        name     score #>            <Rle>       <IRanges>  <Rle> | <character> <numeric> #>     [1]       II   234992-237991      + |     YBL002W         0 #>     [2]       II   226136-229135      + |     YBL004W         0 #>     [3]       II   215970-218969      + |     YBL005W         0 #>     [4]       II   219830-222829      + |   YBL005W-B         0 #>     [5]       II   215211-218210      + |   YBL006W-A         0 #>     ...      ...             ...    ... .         ...       ... #>   [610]       IV 1506505-1509504      + |     YDR536W         0 #>   [611]       IV 1509402-1512401      + |     YDR538W         0 #>   [612]       IV 1510594-1513593      + |     YDR539W         0 #>   [613]       IV 1521749-1524748      + |     YDR542W         0 #>   [614]       IV 1524821-1527820      + |     YDR545W         0 #>   ------- #>   seqinfo: 3 sequences from an unspecified genome  colData(ce) #> DataFrame with 2 rows and 1 column #>               track #>         <character> #> RNA_fwd     RNA_fwd #> RNA_rev     RNA_rev  assays(ce) #> List of length 1 #> names(1): coverage  assay(ce, 'coverage') #>      RNA_fwd         RNA_rev         #> Scc1 numeric,1842000 numeric,1842000  assay(ce[1, 1], 'coverage') #>      RNA_fwd         #> Scc1 numeric,1842000"},{"path":"/articles/tidyCoverage.html","id":"aggregatedcoverage","dir":"Articles","previous_headings":"New classes","what":"AggregatedCoverage","title":"Introduction to tidyCoverage","text":"","code":"showClass(\"AggregatedCoverage\") #> Class \"AggregatedCoverage\" [package \"tidyCoverage\"] #>  #> Slots: #>                                                                  #> Name:                     rowRanges                      colData #> Class: GenomicRanges_OR_GRangesList                    DataFrame #>                                                                  #> Name:                        assays                        NAMES #> Class:               Assays_OR_NULL            character_OR_NULL #>                                                                  #> Name:               elementMetadata                     metadata #> Class:                    DataFrame                         list #>  #> Extends:  #> Class \"RangedSummarizedExperiment\", directly #> Class \"SummarizedExperiment\", by class \"RangedSummarizedExperiment\", distance 2 #> Class \"RectangularData\", by class \"RangedSummarizedExperiment\", distance 3 #> Class \"Vector\", by class \"RangedSummarizedExperiment\", distance 3 #> Class \"Annotated\", by class \"RangedSummarizedExperiment\", distance 4 #> Class \"vector_OR_Vector\", by class \"RangedSummarizedExperiment\", distance 4  data(ac) ac #> class: AggregatedCoverage  #> dim: 1 2  #> metadata(0): #> assays(8): mean median ... ci_low ci_high #> rownames(1): Scc1 #> rowData names(1): features #> colnames(2): RNA_fwd RNA_rev #> colData names(1): track #> width: 3000 #> binning: 1  rowData(ac) #> DataFrame with 1 row and 1 column #>         features #>      <character> #> Scc1        Scc1  rowRanges(ac) #> GRangesList object of length 1: #> $Scc1 #> GRanges object with 614 ranges and 2 metadata columns: #>         seqnames          ranges strand |        name     score #>            <Rle>       <IRanges>  <Rle> | <character> <numeric> #>     [1]       II   234992-237991      + |     YBL002W         0 #>     [2]       II   226136-229135      + |     YBL004W         0 #>     [3]       II   215970-218969      + |     YBL005W         0 #>     [4]       II   219830-222829      + |   YBL005W-B         0 #>     [5]       II   215211-218210      + |   YBL006W-A         0 #>     ...      ...             ...    ... .         ...       ... #>   [610]       IV 1506505-1509504      + |     YDR536W         0 #>   [611]       IV 1509402-1512401      + |     YDR538W         0 #>   [612]       IV 1510594-1513593      + |     YDR539W         0 #>   [613]       IV 1521749-1524748      + |     YDR542W         0 #>   [614]       IV 1524821-1527820      + |     YDR545W         0 #>   ------- #>   seqinfo: 3 sequences from an unspecified genome  colData(ac) #> DataFrame with 2 rows and 1 column #>               track #>         <character> #> RNA_fwd     RNA_fwd #> RNA_rev     RNA_rev  assays(ac) #> List of length 8 #> names(8): mean median min max sd se ci_low ci_high  assay(ac, 'mean') #>      RNA_fwd      RNA_rev      #> Scc1 numeric,3000 numeric,3000  assay(ac[1, 1], 'mean') #>      RNA_fwd      #> Scc1 numeric,3000"},{"path":[]},{"path":"/articles/tidyCoverage.html","id":"creating-a-coverageexperiment-object","dir":"Articles","previous_headings":"CoverageExperiment objects","what":"Creating a CoverageExperiment object","title":"Introduction to tidyCoverage","text":"","code":"library(rtracklayer) bw_file <- system.file(\"extdata\", \"MNase.bw\", package = \"tidyCoverage\") bed_file <- system.file(\"extdata\", \"TSSs.bed\", package = \"tidyCoverage\") CE <- CoverageExperiment(     tracks = import(bw_file, as = \"Rle\"),      features = import(bed_file),     width = 3000 ) CE #> class: CoverageExperiment  #> dim: 1 1  #> metadata(0): #> assays(1): coverage #> rownames(1): features #> rowData names(1): features #> colnames(1): track #> colData names(1): track #> width: 3000"},{"path":"/articles/tidyCoverage.html","id":"bin-a-coverageexperiment-object","dir":"Articles","previous_headings":"CoverageExperiment objects","what":"Bin a CoverageExperiment object","title":"Introduction to tidyCoverage","text":"","code":"coarsen(CE, window = 50) #> class: CoverageExperiment  #> dim: 1 1  #> metadata(0): #> assays(1): coverage #> rownames(1): features #> rowData names(1): features #> colnames(1): track #> colData names(1): track #> width: 3000"},{"path":"/articles/tidyCoverage.html","id":"plot-coverage-of-a-set-of-tracks-over-a-single-genomic-locus","dir":"Articles","previous_headings":"CoverageExperiment objects","what":"Plot coverage of a set of tracks over a single genomic locus","title":"Introduction to tidyCoverage","text":"","code":"library(ggplot2)  # ~~~~~~~~~~~~~~~ Import coverage tracks into a named list ~~~~~~~~~~~~~~~ # tracks <- list(     Scc1 = system.file(\"extdata\", \"Scc1.bw\", package = \"tidyCoverage\"),      RNA_fwd = system.file(\"extdata\", \"RNA.fwd.bw\", package = \"tidyCoverage\"),     RNA_rev = system.file(\"extdata\", \"RNA.rev.bw\", package = \"tidyCoverage\"),     PolII = system.file(\"extdata\", \"PolII.bw\", package = \"tidyCoverage\"),      MNase = system.file(\"extdata\", \"MNase.bw\", package = \"tidyCoverage\") ) |> BigWigFileList()  locus <- \"II:450001-475000\" CE2 <- CoverageExperiment(     tracks = tracks,      features = GRanges(locus),     width = width   (GRanges(locus)) ) |> coarsen(window = width(GRanges(locus))/1000) as_tibble(CE2) |>      ggplot(aes(x = coord, y = coverage)) +          geom_col(aes(fill = track, col = track)) +          facet_grid(track~., scales = 'free') +          scale_x_continuous(expand = c(0, 0)) +          theme_bw() +          theme(legend.position = \"none\", aspect.ratio = 0.1)"},{"path":[]},{"path":"/articles/tidyCoverage.html","id":"aggregating-a-coverageexperiment-into-an-aggregatedcoverage-object","dir":"Articles","previous_headings":"AggregatedCoverage objects","what":"Aggregating a CoverageExperiment into an AggregatedCoverage object","title":"Introduction to tidyCoverage","text":"","code":"AC <- aggregate(CE) AC #> class: AggregatedCoverage  #> dim: 1 1  #> metadata(0): #> assays(8): mean median ... ci_low ci_high #> rownames(1): features #> rowData names(1): features #> colnames(1): track #> colData names(1): track #> width: 3000 #> binning: 1  AC10 <- aggregate(CE, bin = 10) AC10 #> class: AggregatedCoverage  #> dim: 1 1  #> metadata(0): #> assays(8): mean median ... ci_low ci_high #> rownames(1): features #> rowData names(1): features #> colnames(1): track #> colData names(1): track #> width: 3000 #> binning: 10"},{"path":"/articles/tidyCoverage.html","id":"aggregatedcoverage-over-multiple-tracks-feature-sets","dir":"Articles","previous_headings":"AggregatedCoverage objects","what":"AggregatedCoverage over multiple tracks / feature sets","title":"Introduction to tidyCoverage","text":"","code":"library(purrr) #>  #> Attaching package: 'purrr' #> The following object is masked from 'package:GenomicRanges': #>  #>     reduce #> The following object is masked from 'package:IRanges': #>  #>     reduce #> The following object is masked from 'package:base': #>  #>     %||% library(plyranges) #>  #> Attaching package: 'plyranges' #> The following object is masked from 'package:IRanges': #>  #>     slice #> The following object is masked from 'package:stats': #>  #>     filter  # ~~~~~~~~~~~~~~~ Import genomic features into a named list ~~~~~~~~~~~~~~~ # features <- list(     TSSs = system.file(\"extdata\", \"TSSs.bed\", package = \"tidyCoverage\"),     `Convergent transcription` = system.file(\"extdata\", \"conv_transcription_loci.bed\", package = \"tidyCoverage\") ) |> map(import) |> map(filter, strand == '+')   # ~~~~~~~~~~~~~~~ Import coverage tracks into a named list ~~~~~~~~~~~~~~~ # tracks <- list(     Scc1 = system.file(\"extdata\", \"Scc1.bw\", package = \"tidyCoverage\"),      RNA_fwd = system.file(\"extdata\", \"RNA.fwd.bw\", package = \"tidyCoverage\"),     RNA_rev = system.file(\"extdata\", \"RNA.rev.bw\", package = \"tidyCoverage\"),     PolII = system.file(\"extdata\", \"PolII.bw\", package = \"tidyCoverage\"),      MNase = system.file(\"extdata\", \"MNase.bw\", package = \"tidyCoverage\") ) |> map(import, as = 'Rle')  # ~~~~~~~~~~~~~~~ Compute aggregated coverage ~~~~~~~~~~~~~~~ # CE <- CoverageExperiment(tracks, features, width = 5000, scale = TRUE, center = TRUE) CE #> class: CoverageExperiment  #> dim: 2 5  #> metadata(0): #> assays(1): coverage #> rownames(2): TSSs Convergent transcription #> rowData names(1): features #> colnames(5): Scc1 RNA_fwd RNA_rev PolII MNase #> colData names(1): track #> width: 5000  AC <- aggregate(CE) AC #> class: AggregatedCoverage  #> dim: 2 5  #> metadata(0): #> assays(8): mean median ... ci_low ci_high #> rownames(2): TSSs Convergent transcription #> rowData names(1): features #> colnames(5): Scc1 RNA_fwd RNA_rev PolII MNase #> colData names(1): track #> width: 5000 #> binning: 1"},{"path":"/articles/tidyCoverage.html","id":"plotting-aggregated-coverages-with-ggplot2","dir":"Articles","previous_headings":"AggregatedCoverage objects","what":"Plotting aggregated coverages with ggplot2","title":"Introduction to tidyCoverage","text":"","code":"as_tibble(AC) |>      ggplot(aes(x = coord, y = mean)) +      geom_ribbon(aes(ymin = ci_low, ymax = ci_high, fill = track), alpha = 0.2) +      geom_line(aes(col = track)) +      facet_grid(features ~ .) +      labs(x = 'Distance from genomic feature', y = 'Mean coverage') +      theme_bw() +      theme(legend.position = 'top')"},{"path":"/articles/tidyCoverage.html","id":"using-a-tidy-grammar","dir":"Articles","previous_headings":"AggregatedCoverage objects","what":"Using a tidy grammar","title":"Introduction to tidyCoverage","text":"","code":"library(tidySummarizedExperiment)  #> Loading required package: ttservice #>  #> Attaching package: 'tidySummarizedExperiment' #> The following object is masked from 'package:ttservice': #>  #>     plot_ly AC #> # An AggregatedCoverage-tibble abstraction: 50000 × 11 #> # features=2 | tracks=5 | assays=mean, median, min, max, sd, se, ci_low, #> #   ci_high #> # width=5000 | binning=1 #>    track features coord   mean median   min   max    sd     se    ci_low ci_high #>    <chr> <chr>    <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>  <dbl>     <dbl>   <dbl> #>  1 Scc1  TSSs     -2500 0.0827 -0.381 -2.15  7.28  1.36 0.0460  -7.62e-3   0.173 #>  2 Scc1  TSSs     -2499 0.0872 -0.391 -2.13  7.28  1.36 0.0462  -3.50e-3   0.178 #>  3 Scc1  TSSs     -2498 0.0891 -0.391 -2.13  7.28  1.36 0.0462  -1.64e-3   0.180 #>  4 Scc1  TSSs     -2497 0.0888 -0.392 -2.13  7.16  1.35 0.0459  -1.27e-3   0.179 #>  5 Scc1  TSSs     -2496 0.0901 -0.391 -2.13  7.16  1.35 0.0458   8.76e-5   0.180 #>  6 Scc1  TSSs     -2495 0.0862 -0.392 -2.13  6.38  1.33 0.0452  -2.62e-3   0.175 #>  7 Scc1  TSSs     -2494 0.0832 -0.398 -2.13  6.38  1.34 0.0455  -6.10e-3   0.173 #>  8 Scc1  TSSs     -2493 0.0804 -0.402 -2.13  6.38  1.34 0.0454  -8.68e-3   0.169 #>  9 Scc1  TSSs     -2492 0.0825 -0.397 -2.13  6.38  1.34 0.0454  -6.67e-3   0.172 #> 10 Scc1  TSSs     -2491 0.0804 -0.397 -2.13  6.38  1.33 0.0451  -8.09e-3   0.169 #> # ℹ 49,990 more rows  AC |>      filter(track != 'Scc1') |>      filter(features == 'Convergent transcription') |>      ggplot(aes(x = coord, y = mean)) +      geom_ribbon(aes(ymin = ci_low, ymax = ci_high, fill = track), alpha = 0.2) +      geom_line(aes(col = track)) +      facet_grid(track ~ .) +      labs(x = 'Distance from locus of convergent transcription', y = 'Mean coverage') +      theme_bw() +      theme(legend.position = 'top')"},{"path":"/articles/tidyCoverage.html","id":"coarsening-the-aggregated-coverage-statistics","dir":"Articles","previous_headings":"AggregatedCoverage objects","what":"Coarsening the aggregated coverage statistics","title":"Introduction to tidyCoverage","text":"","code":"AC2 <- aggregate(CE, bin = 200) AC2 |>      filter(track != 'Scc1') |>      filter(features == 'Convergent transcription') |>      ggplot(aes(x = coord, y = mean)) +      geom_ribbon(aes(ymin = ci_low, ymax = ci_high, fill = track), alpha = 0.2) +      geom_line(aes(col = track)) +      geom_point(aes(col = track)) +      facet_grid(track ~ .) +      labs(x = 'Distance from locus of convergent transcription', y = 'Mean coverage') +      theme_bw() +      theme(legend.position = 'top')"},{"path":[]},{"path":"/articles/tidyCoverage.html","id":"recovering-tsss-of-forward-human-genes","dir":"Articles","previous_headings":"Example use case: AnnotationHub and TxDb resources","what":"Recovering TSSs of forward human genes","title":"Introduction to tidyCoverage","text":"","code":"txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene::TxDb.Hsapiens.UCSC.hg19.knownGene TSSs <- GenomicFeatures::genes(txdb) |>      filter(strand == '+') |>      anchor_5p() |>      mutate(width = 1) #>   403 genes were dropped because they have exons located on both strands #>   of the same reference sequence or on more than one reference sequence, #>   so cannot be represented by a single genomic range. #>   Use 'single.strand.genes.only=FALSE' to get all the genes in a #>   GRangesList object, or use suppressMessages() to suppress this message."},{"path":"/articles/tidyCoverage.html","id":"recovering-h3k4me3-coverage-track-from-encode","dir":"Articles","previous_headings":"Example use case: AnnotationHub and TxDb resources","what":"Recovering H3K4me3 coverage track from ENCODE","title":"Introduction to tidyCoverage","text":"","code":"library(AnnotationHub) #> Loading required package: BiocFileCache #> Loading required package: dbplyr #>  #> Attaching package: 'dbplyr' #> The following objects are masked from 'package:dplyr': #>  #>     ident, sql #>  #> Attaching package: 'AnnotationHub' #> The following object is masked from 'package:rtracklayer': #>  #>     hubUrl #> The following object is masked from 'package:Biobase': #>  #>     cache ah <- AnnotationHub() ah['AH34904'] #> AnnotationHub with 1 record #> # snapshotDate(): 2023-11-08 #> # names(): AH34904 #> # $dataprovider: BroadInstitute #> # $species: Homo sapiens #> # $rdataclass: BigWigFile #> # $rdatadateadded: 2015-05-07 #> # $title: UCSD.H1.H3K4me3.LL227.fc.signal.bigwig #> # $description: Bigwig File containing fold enrichment signal tracks from Ep... #> # $taxonomyid: 9606 #> # $genome: hg19 #> # $sourcetype: BigWig #> # $sourceurl: http://egg2.wustl.edu/roadmap/data/byFileType/signal/unconsoli... #> # $sourcesize: 97131347 #> # $tags: c(\"EpigenomeRoadMap\", \"signal\", \"unconsolidated\", #> #   \"foldChange\", \"NA\")  #> # retrieve record with 'object[[\"AH34904\"]]' H3K4me3_bw <- ah[['AH34904']] #> loading from cache"},{"path":"/articles/tidyCoverage.html","id":"computing-the-aggregated-coverage-of-h3k4me3-3kb-around-the-tsss-of-forward-human-genes","dir":"Articles","previous_headings":"Example use case: AnnotationHub and TxDb resources","what":"Computing the aggregated coverage of H3K4me3 ± 3kb around the TSSs of forward human genes","title":"Introduction to tidyCoverage","text":"","code":"CE <- CoverageExperiment(     import(H3K4me3_bw, as = 'Rle'),      TSSs,      width = 6000,      scale = TRUE, center = TRUE ) AC <- aggregate(CE) ggplot(AC, aes(x = coord, y = mean)) +      geom_ribbon(aes(ymin = ci_low, ymax = ci_high, fill = track), alpha = 0.2) +      geom_line(aes(col = track)) +      facet_grid(track ~ .) +      labs(x = 'Distance from TSSs', y = 'Mean coverage') +      theme_bw() +      theme(legend.position = 'top')"},{"path":"/articles/tidyCoverage.html","id":"with-more-genomic-tracks","dir":"Articles","previous_headings":"Example use case: AnnotationHub and TxDb resources","what":"With more genomic tracks","title":"Introduction to tidyCoverage","text":"","code":"# ~~~~~~~~~~ Recover 15 different histone PTM ChIP-seq tracks ~~~~~~~~~~ # ids <- c(     'AH35163', 'AH35165', 'AH35167', 'AH35170', 'AH35173', 'AH35176',      'AH35178', 'AH35180', 'AH35182', 'AH35185', 'AH35187', 'AH35189',      'AH35191', 'AH35193', 'AH35196' ) names(ids) <- mcols(ah[ids])$title |>      gsub(\".*IMR90.\", \"\", x = _) |>      gsub(\"\\\\..*\", \"\", x = _) bws <- map(ids, ~ ah[[.x]]) |>      map(resource) |>      BigWigFileList() names(bws) <- names(ids)  # ~~~~~~~~~~ Computing coverage over TSSs ~~~~~~~~~~ # CE <- CoverageExperiment(     bws, TSSs,      width = 4000,      scale = TRUE, center = TRUE )  # ~~~~~~~~~~ Aggregate coverages ~~~~~~~~~~ # AC <- aggregate(CE)  # ~~~~~~~~~~ Plot the resulting AggregatedCoverage object ~~~~~~~~~~ # df <- AC |>      as_tibble() |>      mutate(         histone = dplyr::case_when(             stringr::str_detect(track, 'H2A') ~ \"H2A\",              stringr::str_detect(track, 'H2B') ~ \"H2B\",              stringr::str_detect(track, 'H3') ~ \"H3\"         )     ) p <- df |> ggplot(aes(x = coord, y = mean)) +      geom_ribbon(aes(ymin = ci_low, ymax = ci_high, fill = track), alpha = 0.2) +      geom_line(aes(col = track)) +      facet_grid(~histone) +      labs(x = 'Distance from TSSs', y = 'Mean histone PTM coverage') +      theme_bw() +      theme(legend.position = 'top') +      hues::scale_colour_iwanthue() +      hues::scale_fill_iwanthue()"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jacques Serizay. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jacques (2023). Jacques' Package. doi:10.18129/B9.bioc.AggregatedCoverage, https://github.com//AggregatedCoverage - R package version 0.98.0, http://www.bioconductor.org/packages/AggregatedCoverage. Jacques (2023). “Jacques' Package.” bioRxiv. doi:10.1101/TODO, https://www.biorxiv.org/content/10.1101/TODO.","code":"@Manual{,   title = {Jacques' Package},   author = {{Jacques}},   year = {2023},   url = {http://www.bioconductor.org/packages/AggregatedCoverage},   note = {https://github.com//AggregatedCoverage - R package version 0.98.0},   doi = {10.18129/B9.bioc.AggregatedCoverage}, } @Article{,   title = {Jacques' Package},   author = {{Jacques}},   year = {2023},   journal = {bioRxiv},   doi = {10.1101/TODO},   url = {https://www.biorxiv.org/content/10.1101/TODO}, }"},{"path":[]},{"path":"/reference/AggregatedCoverage.html","id":null,"dir":"Reference","previous_headings":"","what":"aggregate — AggregatedCoverage","title":"aggregate — AggregatedCoverage","text":"Bin coverage contained CoverageExperiment AggregatedCoverage object.","code":""},{"path":"/reference/AggregatedCoverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"aggregate — AggregatedCoverage","text":"","code":"# S4 method for CoverageExperiment aggregate(x, bin = 1, ...)"},{"path":"/reference/AggregatedCoverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"aggregate — AggregatedCoverage","text":"x CoverageExperiment object bin integer bin assay . width AggregatedCoverage object multiple bin. ... ignored","code":""},{"path":"/reference/AggregatedCoverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"aggregate — AggregatedCoverage","text":"AggregatedCoverage object","code":""},{"path":"/reference/AggregatedCoverage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"aggregate — AggregatedCoverage","text":"","code":"data(ce) aggregate(ce, bin = 10) #> # An AggregatedCoverage-tibble abstraction: 600 × 11 #> # features=1 | tracks=2 | assays=mean, median, min, max, sd, se, ci_low, #> #   ci_high #> # width=3000 | binning=10 #>    track  features coord    mean median   min   max    sd     se ci_low  ci_high #>    <chr>  <chr>    <dbl>   <dbl>  <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl>    <dbl> #>  1 RNA_f… Scc1     -1500 -0.0911 -0.609 -3.25 10.5   1.42 0.0572 -0.204  0.0213  #>  2 RNA_f… Scc1     -1490 -0.0942 -0.610 -3.25 10.5   1.41 0.0569 -0.206  0.0176  #>  3 RNA_f… Scc1     -1480 -0.108  -0.610 -3.00  6.31  1.34 0.0540 -0.214 -0.00196 #>  4 RNA_f… Scc1     -1470 -0.103  -0.605 -2.63  6.23  1.32 0.0534 -0.207  0.00228 #>  5 RNA_f… Scc1     -1460 -0.112  -0.591 -2.63  5.47  1.28 0.0517 -0.213 -0.0104  #>  6 RNA_f… Scc1     -1450 -0.110  -0.584 -2.63  5.27  1.27 0.0514 -0.211 -0.00903 #>  7 RNA_f… Scc1     -1440 -0.116  -0.582 -2.63  4.84  1.25 0.0503 -0.215 -0.0168  #>  8 RNA_f… Scc1     -1430 -0.124  -0.583 -2.60  4.75  1.22 0.0492 -0.220 -0.0271  #>  9 RNA_f… Scc1     -1420 -0.128  -0.583 -2.55  4.75  1.19 0.0480 -0.222 -0.0338  #> 10 RNA_f… Scc1     -1410 -0.131  -0.584 -2.57  4.68  1.18 0.0475 -0.224 -0.0372  #> # ℹ 590 more rows"},{"path":"/reference/CoverageExperiment.html","id":null,"dir":"Reference","previous_headings":"","what":"CoverageExperiment — CoverageExperiment","title":"CoverageExperiment — CoverageExperiment","text":"CoverageExperiment objects instantiated using CoverageExperiment() function, can coarsened using coarsen() function.","code":""},{"path":"/reference/CoverageExperiment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CoverageExperiment — CoverageExperiment","text":"","code":"CoverageExperiment(tracks, features, ...)  coarsen(x, window, ...)  # S4 method for BigWigFileList,GRangesList CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for BigWigFileList,GRanges CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for BigWigFileList,list CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for BigWigFile,GRangesList CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for BigWigFile,GRanges CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for BigWigFile,list CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for list,GRangesList CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for list,GRanges CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for list,list CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for RleList,GRangesList CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for RleList,GRanges CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for RleList,list CoverageExperiment(   tracks,   features,   width,   center = FALSE,   scale = FALSE,   ignore.strand = TRUE,   BPPARAM = BiocParallel::bpparam() )  # S4 method for CoverageExperiment coarsen(x, window = 1, BPPARAM = BiocParallel::bpparam())"},{"path":"/reference/CoverageExperiment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CoverageExperiment — CoverageExperiment","text":"tracks genomic track imported RleList named list genomic tracks. features set features imported GRanges named GRangesList. ... Passed relevant method x CoverageExperiment object window integer coarsen coverage . width Width resize set genomic features scale, center Logical, whether scale /center tracks prior summarization ignore.strand Logical, whether take features strand information BPPARAM Passed BiocParallel.","code":""},{"path":"/reference/CoverageExperiment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"CoverageExperiment — CoverageExperiment","text":"CoverageExperiment object","code":""},{"path":"/reference/CoverageExperiment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CoverageExperiment — CoverageExperiment","text":"","code":"library(rtracklayer) library(purrr) #>  #> Attaching package: ‘purrr’ #> The following object is masked from ‘package:GenomicRanges’: #>  #>     reduce #> The following object is masked from ‘package:IRanges’: #>  #>     reduce #> The following object is masked from ‘package:base’: #>  #>     %||% library(plyranges) #>  #> Attaching package: ‘plyranges’ #> The following object is masked from ‘package:IRanges’: #>  #>     slice #> The following object is masked from ‘package:stats’: #>  #>     filter TSSs_bed <- system.file(\"extdata\", \"TSSs.bed\", package = \"tidyCoverage\") features <- import(TSSs_bed) |> filter(strand == '+')  ############################################################################# ## 1. Creating a `CoverageExperiment` object from a single BigWigFile #############################################################################  RNA_fwd <- system.file(\"extdata\", \"RNA.fwd.bw\", package = \"tidyCoverage\") tracks <- BigWigFile(RNA_fwd) CoverageExperiment(tracks, features, width = 5000) #> class: CoverageExperiment  #> dim: 1 1  #> metadata(0): #> assays(1): coverage #> rownames(1): features #> rowData names(1): features #> colnames(1): track #> colData names(1): track #> width: 5000  ############################################################################# ## 2. Creating a `CoverageExperiment` object from a BigWigFileList #############################################################################  RNA_rev <- system.file(\"extdata\", \"RNA.rev.bw\", package = \"tidyCoverage\") tracks <- BigWigFileList(list(RNA_fwd = RNA_fwd, RNA_rev = RNA_rev)) CoverageExperiment(tracks, features, width = 5000) #> class: CoverageExperiment  #> dim: 1 2  #> metadata(0): #> assays(1): coverage #> rownames(1): features #> rowData names(1): features #> colnames(2): RNA_fwd RNA_rev #> colData names(1): track #> width: 5000  ############################################################################# ## 3. Creating a `CoverageExperiment` object from imported bigwig files #############################################################################  tracks <- list(     RNA_fwd = system.file(\"extdata\", \"RNA.fwd.bw\", package = \"tidyCoverage\"),     RNA_rev = system.file(\"extdata\", \"RNA.rev.bw\", package = \"tidyCoverage\") ) |> map(import, as = 'Rle') CoverageExperiment(tracks, features, width = 5000) #> class: CoverageExperiment  #> dim: 1 2  #> metadata(0): #> assays(1): coverage #> rownames(1): features #> rowData names(1): features #> colnames(2): RNA_fwd RNA_rev #> colData names(1): track #> width: 5000  ############################################################################# ## 4. Correct for strandness when recovering coverage #############################################################################  TSSs_bed <- system.file(\"extdata\", \"TSSs.bed\", package = \"tidyCoverage\") features <- list(     TSS_fwd = import(TSSs_bed) |> filter(strand == '+'),      TSS_rev = import(TSSs_bed) |> filter(strand == '-') ) tracks <- list(     RNA_fwd = system.file(\"extdata\", \"RNA.fwd.bw\", package = \"tidyCoverage\"),     RNA_rev = system.file(\"extdata\", \"RNA.rev.bw\", package = \"tidyCoverage\") ) |> map(import, as = 'Rle') CoverageExperiment(tracks, features, width = 5000, ignore.strand = FALSE) #> class: CoverageExperiment  #> dim: 2 2  #> metadata(0): #> assays(1): coverage #> rownames(2): TSS_fwd TSS_rev #> rowData names(1): features #> colnames(2): RNA_fwd RNA_rev #> colData names(1): track #> width: 5000 data(ce) coarsen(ce, window = 10) #> class: CoverageExperiment  #> dim: 1 2  #> metadata(0): #> assays(1): coverage #> rownames(1): Scc1 #> rowData names(1): features #> colnames(2): RNA_fwd RNA_rev #> colData names(1): track #> width: 3000"},{"path":"/reference/as_tibble-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"as_tibble — as_tibble-methods","title":"as_tibble — as_tibble-methods","text":"Coerce CoverageExperiment object tibble","code":""},{"path":"/reference/as_tibble-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"as_tibble — as_tibble-methods","text":"","code":"# S3 method for CoverageExperiment as_tibble(x, ...)  # S3 method for AggregatedCoverage as_tibble(x, ...)"},{"path":"/reference/as_tibble-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"as_tibble — as_tibble-methods","text":"x CoverageExperiment object ... ignored","code":""},{"path":"/reference/as_tibble-methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"as_tibble — as_tibble-methods","text":"tibble","code":""},{"path":"/reference/as_tibble-methods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"as_tibble — as_tibble-methods","text":"","code":"data(ac) as_tibble(ac) #> # A tibble: 6,000 × 11 #>    track   features coord    mean median   min   max    sd     se ci_low ci_high #>    <chr>   <chr>    <dbl>   <dbl>  <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl>   <dbl> #>  1 RNA_fwd Scc1     -1500 -0.0921 -0.611 -3.25  10.5  1.42 0.0572 -0.204  0.0203 #>  2 RNA_fwd Scc1     -1499 -0.0915 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0208 #>  3 RNA_fwd Scc1     -1498 -0.0898 -0.609 -3.25  10.5  1.42 0.0573 -0.202  0.0227 #>  4 RNA_fwd Scc1     -1497 -0.0914 -0.609 -3.25  10.5  1.42 0.0573 -0.204  0.0211 #>  5 RNA_fwd Scc1     -1496 -0.0915 -0.609 -3.25  10.5  1.42 0.0573 -0.204  0.0211 #>  6 RNA_fwd Scc1     -1495 -0.0912 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0212 #>  7 RNA_fwd Scc1     -1494 -0.0912 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0211 #>  8 RNA_fwd Scc1     -1493 -0.0915 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0209 #>  9 RNA_fwd Scc1     -1492 -0.0907 -0.609 -3.25  10.5  1.42 0.0573 -0.203  0.0218 #> 10 RNA_fwd Scc1     -1491 -0.0903 -0.609 -3.25  10.5  1.42 0.0572 -0.203  0.0220 #> # ℹ 5,990 more rows"},{"path":"/reference/data.html","id":null,"dir":"Reference","previous_headings":"","what":"Stranded RNA-seq coverage in yeast — ce","title":"Stranded RNA-seq coverage in yeast — ce","text":"CoverageExperiment dataset containing stranded RNA-seq coverage (forward reverse) Scc1 peaks (± 1kb). Data generated yeast (S288c) aligned reference R64-1-1. AggregatedCoverage dataset summarizing stranded RNA-seq coverage (forward reverse) Scc1 peaks (± 1kb). Data generated yeast (S288c) aligned reference R64-1-1.","code":""},{"path":"/reference/data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stranded RNA-seq coverage in yeast — ce","text":"","code":"data(ce)  data(ac)"},{"path":"/reference/data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Stranded RNA-seq coverage in yeast — ce","text":"CoverageExperiment object containing 1 features set 2 tracks. AggregatedCoverage object containing 1 features set 2 tracks.","code":""},{"path":"/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. dplyr as_tibble S4Vectors aggregate","code":""},{"path":"/reference/reexports.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Objects exported from other packages — reexports","text":"Depending re-exported function","code":""},{"path":"/reference/reexports.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Objects exported from other packages — reexports","text":"","code":"1 + 1 #> [1] 2"},{"path":"/reference/show.html","id":null,"dir":"Reference","previous_headings":"","what":"show — show","title":"show — show","text":"show method CoverageExperiment AggregatedCoverage objects","code":""},{"path":"/reference/show.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"show — show","text":"","code":"# S4 method for CoverageExperiment show(object)  # S4 method for AggregatedCoverage show(object)  # S3 method for AggregatedCoverage print(x, ..., n = NULL)  # S3 method for tidyAggregatedCoverage tbl_format_header(x, setup, ...)"},{"path":"/reference/show.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"show — show","text":"object CoverageExperiment AggregatedCoverage object x Object format print. ... Passed tbl_format_setup(). n Number rows show. NULL, default, print rows less print_max option. Otherwise, print many rows specified print_min option. setup setup object returned pillar::tbl_format_setup().","code":""},{"path":"/reference/show.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"show — show","text":"Prints message console describing contents CoverageExperimentorAggregatedCoverage` objects.","code":""},{"path":"/reference/show.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"show — show","text":"","code":"data(ce) print(ce) #> class: CoverageExperiment  #> dim: 1 2  #> metadata(0): #> assays(1): coverage #> rownames(1): Scc1 #> rowData names(1): features #> colnames(2): RNA_fwd RNA_rev #> colData names(1): track #> width: 3000 data(ac) print(ac) #> # An AggregatedCoverage-tibble abstraction: 6000 × 11 #> # features=1 | tracks=2 | assays=mean, median, min, max, sd, se, ci_low, #> #   ci_high #> # width=3000 | binning=1 #>    track   features coord    mean median   min   max    sd     se ci_low ci_high #>    <chr>   <chr>    <dbl>   <dbl>  <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl>   <dbl> #>  1 RNA_fwd Scc1     -1500 -0.0921 -0.611 -3.25  10.5  1.42 0.0572 -0.204  0.0203 #>  2 RNA_fwd Scc1     -1499 -0.0915 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0208 #>  3 RNA_fwd Scc1     -1498 -0.0898 -0.609 -3.25  10.5  1.42 0.0573 -0.202  0.0227 #>  4 RNA_fwd Scc1     -1497 -0.0914 -0.609 -3.25  10.5  1.42 0.0573 -0.204  0.0211 #>  5 RNA_fwd Scc1     -1496 -0.0915 -0.609 -3.25  10.5  1.42 0.0573 -0.204  0.0211 #>  6 RNA_fwd Scc1     -1495 -0.0912 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0212 #>  7 RNA_fwd Scc1     -1494 -0.0912 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0211 #>  8 RNA_fwd Scc1     -1493 -0.0915 -0.609 -3.25  10.5  1.42 0.0572 -0.204  0.0209 #>  9 RNA_fwd Scc1     -1492 -0.0907 -0.609 -3.25  10.5  1.42 0.0573 -0.203  0.0218 #> 10 RNA_fwd Scc1     -1491 -0.0903 -0.609 -3.25  10.5  1.42 0.0572 -0.203  0.0220 #> # ℹ 5,990 more rows"}]
