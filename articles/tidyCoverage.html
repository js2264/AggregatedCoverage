<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tidyCoverage">
<title>Introduction to tidyCoverage • tidyCoverage</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to tidyCoverage">
<meta property="og:description" content="tidyCoverage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidyCoverage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.98.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/tidyCoverage.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/js2264/tidyCoverage/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to tidyCoverage</h1>
            
            <h4 data-toc-skip class="date">5 December 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/js2264/tidyCoverage/blob/HEAD/vignettes/tidyCoverage.Rmd" class="external-link"><code>vignettes/tidyCoverage.Rmd</code></a></small>
      <div class="d-none name"><code>tidyCoverage.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Genome-wide assays provide powerful methods to profile the
composition, the conformation and the activity of the chromatin. Linear
“coverage” tracks (generally stored as <code>.bigwig</code> files) are
one of the outputs obtained when processing raw high-throughput
sequencing data. These coverage tracks can be inspected in genome
interactive browsers (e.g. <code>IGV</code>) to visually appreciate
local or global variations in the coverage of specific genomic
assays.</p>
<p>The coverage signal aggregated over multiple genomic features can
also be computed. This approach is very efficient to summarize and
compare the coverage of chromatin modalities (e.g. protein binding
profiles from ChIP-seq, transcription profiles from RNA-seq, chromatin
accessibility from ATAC-seq, …) over hundreds and up to thousands of
genomic features of interest. This unlocks a more quantitative
description of the coverage over groups of genomic features.</p>
<p><code>tidyCoverage</code> implements the
<code>CoverageExperiment</code> and the <code>AggregatedCoverage</code>
classes built on top of the <code>SummarizedExperiment</code> class.
These classes formalize the extraction and aggregation of coverage
tracks over sets of genomic features of interests.</p>
</div>
<div class="section level2">
<h2 id="coverageexperiment-and-aggregatedcoverage-classes">
<code>CoverageExperiment</code> and <code>AggregatedCoverage</code>
classes<a class="anchor" aria-label="anchor" href="#coverageexperiment-and-aggregatedcoverage-classes"></a>
</h2>
<div class="section level3">
<h3 id="coverageexperiment">
<code>CoverageExperiment</code><a class="anchor" aria-label="anchor" href="#coverageexperiment"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/tidyCoverage" class="external-link">tidyCoverage</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/RClassUtils.html" class="external-link">showClass</a></span><span class="op">(</span><span class="st">"CoverageExperiment"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class "CoverageExperiment" [package "tidyCoverage"]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slots:</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt; Name:                     rowRanges                      colData</span></span>
<span><span class="co">#&gt; Class: GenomicRanges_OR_GRangesList                    DataFrame</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt; Name:                        assays                        NAMES</span></span>
<span><span class="co">#&gt; Class:               Assays_OR_NULL            character_OR_NULL</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt; Name:               elementMetadata                     metadata</span></span>
<span><span class="co">#&gt; Class:                    DataFrame                         list</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Extends: </span></span>
<span><span class="co">#&gt; Class "RangedSummarizedExperiment", directly</span></span>
<span><span class="co">#&gt; Class "SummarizedExperiment", by class "RangedSummarizedExperiment", distance 2</span></span>
<span><span class="co">#&gt; Class "RectangularData", by class "RangedSummarizedExperiment", distance 3</span></span>
<span><span class="co">#&gt; Class "Vector", by class "RangedSummarizedExperiment", distance 3</span></span>
<span><span class="co">#&gt; Class "Annotated", by class "RangedSummarizedExperiment", distance 4</span></span>
<span><span class="co">#&gt; Class "vector_OR_Vector", by class "RangedSummarizedExperiment", distance 4</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ce</span><span class="op">)</span></span>
<span><span class="va">ce</span></span>
<span><span class="co">#&gt; class: CoverageExperiment </span></span>
<span><span class="co">#&gt; dim: 1 2 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): coverage</span></span>
<span><span class="co">#&gt; rownames(1): Scc1</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(2): RNA_fwd RNA_rev</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 3000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ce</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 1 row and 1 column</span></span>
<span><span class="co">#&gt;         features</span></span>
<span><span class="co">#&gt;      &lt;character&gt;</span></span>
<span><span class="co">#&gt; Scc1        Scc1</span></span>
<span></span>
<span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">ce</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRangesList object of length 1:</span></span>
<span><span class="co">#&gt; $Scc1</span></span>
<span><span class="co">#&gt; GRanges object with 614 ranges and 2 metadata columns:</span></span>
<span><span class="co">#&gt;         seqnames          ranges strand |        name     score</span></span>
<span><span class="co">#&gt;            &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;     [1]       II   234992-237991      + |     YBL002W         0</span></span>
<span><span class="co">#&gt;     [2]       II   226136-229135      + |     YBL004W         0</span></span>
<span><span class="co">#&gt;     [3]       II   215970-218969      + |     YBL005W         0</span></span>
<span><span class="co">#&gt;     [4]       II   219830-222829      + |   YBL005W-B         0</span></span>
<span><span class="co">#&gt;     [5]       II   215211-218210      + |   YBL006W-A         0</span></span>
<span><span class="co">#&gt;     ...      ...             ...    ... .         ...       ...</span></span>
<span><span class="co">#&gt;   [610]       IV 1506505-1509504      + |     YDR536W         0</span></span>
<span><span class="co">#&gt;   [611]       IV 1509402-1512401      + |     YDR538W         0</span></span>
<span><span class="co">#&gt;   [612]       IV 1510594-1513593      + |     YDR539W         0</span></span>
<span><span class="co">#&gt;   [613]       IV 1521749-1524748      + |     YDR542W         0</span></span>
<span><span class="co">#&gt;   [614]       IV 1524821-1527820      + |     YDR545W         0</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 3 sequences from an unspecified genome</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">ce</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 2 rows and 1 column</span></span>
<span><span class="co">#&gt;               track</span></span>
<span><span class="co">#&gt;         &lt;character&gt;</span></span>
<span><span class="co">#&gt; RNA_fwd     RNA_fwd</span></span>
<span><span class="co">#&gt; RNA_rev     RNA_rev</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">ce</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of length 1</span></span>
<span><span class="co">#&gt; names(1): coverage</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">ce</span>, <span class="st">'coverage'</span><span class="op">)</span></span>
<span><span class="co">#&gt;      RNA_fwd         RNA_rev        </span></span>
<span><span class="co">#&gt; Scc1 numeric,1842000 numeric,1842000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">ce</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, <span class="st">'coverage'</span><span class="op">)</span></span>
<span><span class="co">#&gt;      RNA_fwd        </span></span>
<span><span class="co">#&gt; Scc1 numeric,1842000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aggregatedcoverage">
<code>AggregatedCoverage</code><a class="anchor" aria-label="anchor" href="#aggregatedcoverage"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/RClassUtils.html" class="external-link">showClass</a></span><span class="op">(</span><span class="st">"AggregatedCoverage"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class "AggregatedCoverage" [package "tidyCoverage"]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slots:</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt; Name:                     rowRanges                      colData</span></span>
<span><span class="co">#&gt; Class: GenomicRanges_OR_GRangesList                    DataFrame</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt; Name:                        assays                        NAMES</span></span>
<span><span class="co">#&gt; Class:               Assays_OR_NULL            character_OR_NULL</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt; Name:               elementMetadata                     metadata</span></span>
<span><span class="co">#&gt; Class:                    DataFrame                         list</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Extends: </span></span>
<span><span class="co">#&gt; Class "RangedSummarizedExperiment", directly</span></span>
<span><span class="co">#&gt; Class "SummarizedExperiment", by class "RangedSummarizedExperiment", distance 2</span></span>
<span><span class="co">#&gt; Class "RectangularData", by class "RangedSummarizedExperiment", distance 3</span></span>
<span><span class="co">#&gt; Class "Vector", by class "RangedSummarizedExperiment", distance 3</span></span>
<span><span class="co">#&gt; Class "Annotated", by class "RangedSummarizedExperiment", distance 4</span></span>
<span><span class="co">#&gt; Class "vector_OR_Vector", by class "RangedSummarizedExperiment", distance 4</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ac</span><span class="op">)</span></span>
<span><span class="va">ac</span></span>
<span><span class="co">#&gt; class: AggregatedCoverage </span></span>
<span><span class="co">#&gt; dim: 1 2 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(8): mean median ... ci_low ci_high</span></span>
<span><span class="co">#&gt; rownames(1): Scc1</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(2): RNA_fwd RNA_rev</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 3000</span></span>
<span><span class="co">#&gt; binning: 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ac</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 1 row and 1 column</span></span>
<span><span class="co">#&gt;         features</span></span>
<span><span class="co">#&gt;      &lt;character&gt;</span></span>
<span><span class="co">#&gt; Scc1        Scc1</span></span>
<span></span>
<span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">ac</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRangesList object of length 1:</span></span>
<span><span class="co">#&gt; $Scc1</span></span>
<span><span class="co">#&gt; GRanges object with 614 ranges and 2 metadata columns:</span></span>
<span><span class="co">#&gt;         seqnames          ranges strand |        name     score</span></span>
<span><span class="co">#&gt;            &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;     [1]       II   234992-237991      + |     YBL002W         0</span></span>
<span><span class="co">#&gt;     [2]       II   226136-229135      + |     YBL004W         0</span></span>
<span><span class="co">#&gt;     [3]       II   215970-218969      + |     YBL005W         0</span></span>
<span><span class="co">#&gt;     [4]       II   219830-222829      + |   YBL005W-B         0</span></span>
<span><span class="co">#&gt;     [5]       II   215211-218210      + |   YBL006W-A         0</span></span>
<span><span class="co">#&gt;     ...      ...             ...    ... .         ...       ...</span></span>
<span><span class="co">#&gt;   [610]       IV 1506505-1509504      + |     YDR536W         0</span></span>
<span><span class="co">#&gt;   [611]       IV 1509402-1512401      + |     YDR538W         0</span></span>
<span><span class="co">#&gt;   [612]       IV 1510594-1513593      + |     YDR539W         0</span></span>
<span><span class="co">#&gt;   [613]       IV 1521749-1524748      + |     YDR542W         0</span></span>
<span><span class="co">#&gt;   [614]       IV 1524821-1527820      + |     YDR545W         0</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 3 sequences from an unspecified genome</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">ac</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 2 rows and 1 column</span></span>
<span><span class="co">#&gt;               track</span></span>
<span><span class="co">#&gt;         &lt;character&gt;</span></span>
<span><span class="co">#&gt; RNA_fwd     RNA_fwd</span></span>
<span><span class="co">#&gt; RNA_rev     RNA_rev</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">ac</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of length 8</span></span>
<span><span class="co">#&gt; names(8): mean median min max sd se ci_low ci_high</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">ac</span>, <span class="st">'mean'</span><span class="op">)</span></span>
<span><span class="co">#&gt;      RNA_fwd      RNA_rev     </span></span>
<span><span class="co">#&gt; Scc1 numeric,3000 numeric,3000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">ac</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, <span class="st">'mean'</span><span class="op">)</span></span>
<span><span class="co">#&gt;      RNA_fwd     </span></span>
<span><span class="co">#&gt; Scc1 numeric,3000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="manipulate-coverageexperiment-objects">Manipulate <code>CoverageExperiment</code> objects<a class="anchor" aria-label="anchor" href="#manipulate-coverageexperiment-objects"></a>
</h2>
<div class="section level3">
<h3 id="create-a-coverageexperiment-object">Create a <code>CoverageExperiment</code> object<a class="anchor" aria-label="anchor" href="#create-a-coverageexperiment-object"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span></span>
<span><span class="va">bw_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MNase.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span></span>
<span><span class="va">bed_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"TSSs.bed"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span></span>
<span><span class="va">CE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoverageExperiment.html">CoverageExperiment</a></span><span class="op">(</span></span>
<span>    tracks <span class="op">=</span> <span class="fu">import</span><span class="op">(</span><span class="va">bw_file</span>, as <span class="op">=</span> <span class="st">"Rle"</span><span class="op">)</span>, </span>
<span>    features <span class="op">=</span> <span class="fu">import</span><span class="op">(</span><span class="va">bed_file</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">3000</span></span>
<span><span class="op">)</span></span>
<span><span class="va">CE</span></span>
<span><span class="co">#&gt; class: CoverageExperiment </span></span>
<span><span class="co">#&gt; dim: 1 1 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): coverage</span></span>
<span><span class="co">#&gt; rownames(1): features</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(1): track</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 3000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bin-a-coverageexperiment-object">Bin a <code>CoverageExperiment</code> object<a class="anchor" aria-label="anchor" href="#bin-a-coverageexperiment-object"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CoverageExperiment.html">coarsen</a></span><span class="op">(</span><span class="va">CE</span>, window <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt; class: CoverageExperiment </span></span>
<span><span class="co">#&gt; dim: 1 1 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): coverage</span></span>
<span><span class="co">#&gt; rownames(1): features</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(1): track</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 3000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="expand-a-coverageexperiment-object">Expand a <code>CoverageExperiment</code> object<a class="anchor" aria-label="anchor" href="#expand-a-coverageexperiment-object"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/expand.html">expand</a></span><span class="op">(</span><span class="va">CE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,355,000 × 7</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   track, features, ranges [1,785]</span></span></span>
<span><span class="co">#&gt;    track features chr   ranges             strand  coord coverage</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>967     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>968     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>969     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>970     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>971     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>972     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>973     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>974     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>975     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> track features II    II:235967-238966:- -      <span style="text-decoration: underline;">235</span>976     1.24</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,354,990 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-coverage-of-a-set-of-tracks-over-a-single-genomic-locus">Plot coverage of a set of tracks over a single genomic locus<a class="anchor" aria-label="anchor" href="#plot-coverage-of-a-set-of-tracks-over-a-single-genomic-locus"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ~~~~~~~~~~~~~~~ Import coverage tracks into a named list ~~~~~~~~~~~~~~~ #</span></span>
<span><span class="va">tracks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Scc1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Scc1.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>, </span>
<span>    RNA_fwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"RNA.fwd.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>,</span>
<span>    RNA_rev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"RNA.rev.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>,</span>
<span>    PolII <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"PolII.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>, </span>
<span>    MNase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MNase.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/BigWigFile.html" class="external-link">BigWigFileList</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">locus</span> <span class="op">&lt;-</span> <span class="st">"II:450001-475000"</span></span>
<span><span class="va">CE2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoverageExperiment.html">CoverageExperiment</a></span><span class="op">(</span></span>
<span>    tracks <span class="op">=</span> <span class="va">tracks</span>, </span>
<span>    features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="va">locus</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span>   <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="va">locus</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CoverageExperiment.html">coarsen</a></span><span class="op">(</span>window <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="va">locus</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">CE2</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/expand.html">expand</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coord</span>, y <span class="op">=</span> <span class="va">coverage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">track</span>, col <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">track</span><span class="op">~</span><span class="va">.</span>, scales <span class="op">=</span> <span class="st">'free'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidyCoverage_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="manipulate-aggregatedcoverage-objects">Manipulate <code>AggregatedCoverage</code> objects<a class="anchor" aria-label="anchor" href="#manipulate-aggregatedcoverage-objects"></a>
</h2>
<div class="section level3">
<h3 id="aggregate-a-coverageexperiment-into-an-aggregatedcoverage-object">Aggregate a <code>CoverageExperiment</code> into an
<code>AggregatedCoverage</code> object<a class="anchor" aria-label="anchor" href="#aggregate-a-coverageexperiment-into-an-aggregatedcoverage-object"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">CE</span><span class="op">)</span></span>
<span><span class="va">AC</span></span>
<span><span class="co">#&gt; class: AggregatedCoverage </span></span>
<span><span class="co">#&gt; dim: 1 1 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(8): mean median ... ci_low ci_high</span></span>
<span><span class="co">#&gt; rownames(1): features</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(1): track</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 3000</span></span>
<span><span class="co">#&gt; binning: 1</span></span>
<span></span>
<span><span class="va">AC10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">CE</span>, bin <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">AC10</span></span>
<span><span class="co">#&gt; class: AggregatedCoverage </span></span>
<span><span class="co">#&gt; dim: 1 1 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(8): mean median ... ci_low ci_high</span></span>
<span><span class="co">#&gt; rownames(1): features</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(1): track</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 3000</span></span>
<span><span class="co">#&gt; binning: 10</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aggregatedcoverage-over-multiple-tracks-feature-sets">
<code>AggregatedCoverage</code> over multiple tracks / feature
sets<a class="anchor" aria-label="anchor" href="#aggregatedcoverage-over-multiple-tracks-feature-sets"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'purrr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:GenomicRanges':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     reduce</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:IRanges':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     reduce</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %||%</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plyranges</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'plyranges'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:IRanges':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     slice</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span></span>
<span><span class="co"># ~~~~~~~~~~~~~~~ Import genomic features into a named list ~~~~~~~~~~~~~~~ #</span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    TSSs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"TSSs.bed"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>,</span>
<span>    `Convergent transcription` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"conv_transcription_loci.bed"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">import</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">filter</span>, <span class="va">strand</span> <span class="op">==</span> <span class="st">'+'</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># ~~~~~~~~~~~~~~~ Import coverage tracks into a named list ~~~~~~~~~~~~~~~ #</span></span>
<span><span class="va">tracks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Scc1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Scc1.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>, </span>
<span>    RNA_fwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"RNA.fwd.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>,</span>
<span>    RNA_rev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"RNA.rev.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>,</span>
<span>    PolII <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"PolII.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span>, </span>
<span>    MNase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MNase.bw"</span>, package <span class="op">=</span> <span class="st">"tidyCoverage"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">import</span>, as <span class="op">=</span> <span class="st">'Rle'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ~~~~~~~~~~~~~~~ Compute aggregated coverage ~~~~~~~~~~~~~~~ #</span></span>
<span><span class="va">CE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoverageExperiment.html">CoverageExperiment</a></span><span class="op">(</span><span class="va">tracks</span>, <span class="va">features</span>, width <span class="op">=</span> <span class="fl">5000</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">CE</span></span>
<span><span class="co">#&gt; class: CoverageExperiment </span></span>
<span><span class="co">#&gt; dim: 2 5 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): coverage</span></span>
<span><span class="co">#&gt; rownames(2): TSSs Convergent transcription</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(5): Scc1 RNA_fwd RNA_rev PolII MNase</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 5000</span></span>
<span></span>
<span><span class="va">AC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">CE</span><span class="op">)</span></span>
<span><span class="va">AC</span></span>
<span><span class="co">#&gt; class: AggregatedCoverage </span></span>
<span><span class="co">#&gt; dim: 2 5 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(8): mean median ... ci_low ci_high</span></span>
<span><span class="co">#&gt; rownames(2): TSSs Convergent transcription</span></span>
<span><span class="co">#&gt; rowData names(1): features</span></span>
<span><span class="co">#&gt; colnames(5): Scc1 RNA_fwd RNA_rev PolII MNase</span></span>
<span><span class="co">#&gt; colData names(1): track</span></span>
<span><span class="co">#&gt; width: 5000</span></span>
<span><span class="co">#&gt; binning: 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-aggregated-coverages-with-ggplot2">Plot aggregated coverages with <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#plot-aggregated-coverages-with-ggplot2"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">AC</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coord</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci_low</span>, ymax <span class="op">=</span> <span class="va">ci_high</span>, fill <span class="op">=</span> <span class="va">track</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">features</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Distance from genomic feature'</span>, y <span class="op">=</span> <span class="st">'Mean coverage'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidyCoverage_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="use-a-tidy-grammar">Use a tidy grammar<a class="anchor" aria-label="anchor" href="#use-a-tidy-grammar"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stemangiola/tidySummarizedExperiment" class="external-link">tidySummarizedExperiment</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ttservice</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidySummarizedExperiment'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ttservice':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     plot_ly</span></span>
<span><span class="va">CE</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">track</span> <span class="op">!=</span> <span class="st">'Scc1'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">features</span> <span class="op">==</span> <span class="st">'Convergent transcription'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coord</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci_low</span>, ymax <span class="op">=</span> <span class="va">ci_high</span>, fill <span class="op">=</span> <span class="va">track</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">track</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Distance from locus of convergent transcription'</span>, y <span class="op">=</span> <span class="st">'RNA-seq coverage'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidyCoverage_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="coarsen-the-aggregated-coverage-statistics">Coarsen the aggregated coverage statistics<a class="anchor" aria-label="anchor" href="#coarsen-the-aggregated-coverage-statistics"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CE</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">track</span> <span class="op">!=</span> <span class="st">'Scc1'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">features</span> <span class="op">==</span> <span class="st">'Convergent transcription'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>bin <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coord</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci_low</span>, ymax <span class="op">=</span> <span class="va">ci_high</span>, fill <span class="op">=</span> <span class="va">track</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">track</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Distance from locus of convergent transcription'</span>, y <span class="op">=</span> <span class="st">'Mean coverage'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidyCoverage_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="example-use-case-annotationhub-and-txdb-resources">Example use case: <code>AnnotationHub</code> and <code>TxDb</code>
resources<a class="anchor" aria-label="anchor" href="#example-use-case-annotationhub-and-txdb-resources"></a>
</h2>
<div class="section level3">
<h3 id="recover-tsss-of-forward-human-genes">Recover TSSs of forward human genes<a class="anchor" aria-label="anchor" href="#recover-tsss-of-forward-human-genes"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">txdb</span> <span class="op">&lt;-</span> <span class="fu">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/TxDb.Hsapiens.UCSC.hg19.knownGene/man/package.html" class="external-link">TxDb.Hsapiens.UCSC.hg19.knownGene</a></span></span>
<span><span class="va">TSSs</span> <span class="op">&lt;-</span> <span class="fu">GenomicFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/transcripts.html" class="external-link">genes</a></span><span class="op">(</span><span class="va">txdb</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">strand</span> <span class="op">==</span> <span class="st">'+'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/ranges-anchor.html" class="external-link">anchor_5p</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   403 genes were dropped because they have exons located on both strands</span></span>
<span><span class="co">#&gt;   of the same reference sequence or on more than one reference sequence,</span></span>
<span><span class="co">#&gt;   so cannot be represented by a single genomic range.</span></span>
<span><span class="co">#&gt;   Use 'single.strand.genes.only=FALSE' to get all the genes in a</span></span>
<span><span class="co">#&gt;   GRangesList object, or use suppressMessages() to suppress this message.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recover-h3k4me3-coverage-track-from-encode">Recover H3K4me3 coverage track from ENCODE<a class="anchor" aria-label="anchor" href="#recover-h3k4me3-coverage-track-from-encode"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">AnnotationHub</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: BiocFileCache</span></span>
<span><span class="co">#&gt; Loading required package: dbplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dbplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     ident, sql</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'AnnotationHub'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:rtracklayer':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     hubUrl</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:Biobase':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cache</span></span>
<span><span class="va">ah</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html" class="external-link">AnnotationHub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ah</span><span class="op">[</span><span class="st">'AH34904'</span><span class="op">]</span></span>
<span><span class="co">#&gt; AnnotationHub with 1 record</span></span>
<span><span class="co">#&gt; # snapshotDate(): 2023-11-08</span></span>
<span><span class="co">#&gt; # names(): AH34904</span></span>
<span><span class="co">#&gt; # $dataprovider: BroadInstitute</span></span>
<span><span class="co">#&gt; # $species: Homo sapiens</span></span>
<span><span class="co">#&gt; # $rdataclass: BigWigFile</span></span>
<span><span class="co">#&gt; # $rdatadateadded: 2015-05-07</span></span>
<span><span class="co">#&gt; # $title: UCSD.H1.H3K4me3.LL227.fc.signal.bigwig</span></span>
<span><span class="co">#&gt; # $description: Bigwig File containing fold enrichment signal tracks from Ep...</span></span>
<span><span class="co">#&gt; # $taxonomyid: 9606</span></span>
<span><span class="co">#&gt; # $genome: hg19</span></span>
<span><span class="co">#&gt; # $sourcetype: BigWig</span></span>
<span><span class="co">#&gt; # $sourceurl: http://egg2.wustl.edu/roadmap/data/byFileType/signal/unconsoli...</span></span>
<span><span class="co">#&gt; # $sourcesize: 97131347</span></span>
<span><span class="co">#&gt; # $tags: c("EpigenomeRoadMap", "signal", "unconsolidated",</span></span>
<span><span class="co">#&gt; #   "foldChange", "NA") </span></span>
<span><span class="co">#&gt; # retrieve record with 'object[["AH34904"]]'</span></span>
<span><span class="va">H3K4me3_bw</span> <span class="op">&lt;-</span> <span class="va">ah</span><span class="op">[[</span><span class="st">'AH34904'</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; loading from cache</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compute-the-aggregated-coverage-of-h3k4me3-3kb-around-the-tsss-of-forward-human-genes">Compute the aggregated coverage of H3K4me3 ± 3kb around the TSSs of
forward human genes<a class="anchor" aria-label="anchor" href="#compute-the-aggregated-coverage-of-h3k4me3-3kb-around-the-tsss-of-forward-human-genes"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoverageExperiment.html">CoverageExperiment</a></span><span class="op">(</span></span>
<span>    <span class="va">H3K4me3_bw</span>, <span class="va">TSSs</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">6000</span>, </span>
<span>    scale <span class="op">=</span> <span class="cn">TRUE</span>, center <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">AC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">CE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">AC</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coord</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci_low</span>, ymax <span class="op">=</span> <span class="va">ci_high</span>, fill <span class="op">=</span> <span class="va">track</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">track</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Distance from TSSs'</span>, y <span class="op">=</span> <span class="st">'Mean coverage'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidyCoverage_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="with-more-genomic-tracks">With more genomic tracks<a class="anchor" aria-label="anchor" href="#with-more-genomic-tracks"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ~~~~~~~~~~ Recover 15 different histone PTM ChIP-seq tracks ~~~~~~~~~~ #</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">'AH35163'</span>, <span class="st">'AH35165'</span>, <span class="st">'AH35167'</span>, <span class="st">'AH35170'</span>, <span class="st">'AH35173'</span>, <span class="st">'AH35176'</span>, </span>
<span>    <span class="st">'AH35178'</span>, <span class="st">'AH35180'</span>, <span class="st">'AH35182'</span>, <span class="st">'AH35185'</span>, <span class="st">'AH35187'</span>, <span class="st">'AH35189'</span>, </span>
<span>    <span class="st">'AH35191'</span>, <span class="st">'AH35193'</span>, <span class="st">'AH35196'</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">mcols</span><span class="op">(</span><span class="va">ah</span><span class="op">[</span><span class="va">ids</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">title</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*IMR90."</span>, <span class="st">""</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\..*"</span>, <span class="st">""</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span></span>
<span><span class="va">bws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">ids</span>, <span class="op">~</span> <span class="va">ah</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">resource</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/BigWigFile.html" class="external-link">BigWigFileList</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bws</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ~~~~~~~~~~ Computing coverage over TSSs ~~~~~~~~~~ #</span></span>
<span><span class="va">AC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoverageExperiment.html">CoverageExperiment</a></span><span class="op">(</span></span>
<span>    <span class="va">bws</span>, <span class="va">TSSs</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">4000</span>, </span>
<span>    scale <span class="op">=</span> <span class="cn">TRUE</span>, center <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ~~~~~~~~~~ Plot the resulting AggregatedCoverage object ~~~~~~~~~~ #</span></span>
<span><span class="va">AC</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        histone <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>            <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">track</span>, <span class="st">'H2A'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"H2A"</span>, </span>
<span>            <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">track</span>, <span class="st">'H2B'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"H2B"</span>, </span>
<span>            <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">track</span>, <span class="st">'H3'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"H3"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coord</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci_low</span>, ymax <span class="op">=</span> <span class="va">ci_high</span>, fill <span class="op">=</span> <span class="va">track</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">histone</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Distance from TSSs'</span>, y <span class="op">=</span> <span class="st">'Mean histone PTM coverage'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">hues</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hues/man/hues-ggplot2-scales.html" class="external-link">scale_colour_iwanthue</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">hues</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hues/man/hues-ggplot2-scales.html" class="external-link">scale_fill_iwanthue</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="../reference/figures/PTMs-TSSs.png"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jacques Serizay.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
